Description: fix directory traversal issue resulting in connection
 modification and possible arbitrary file disclosure
Author: Mathieu Trudel-Lapierre <mathieu-tl@ubuntu.com>
Bug-Ubuntu: https://bugs.launchpad.net/ubuntu/+source/network-manager/+bug/1449245

Index: network-manager-0.9.10.0/src/settings/plugins/ofono/plugin.c
===================================================================
--- network-manager-0.9.10.0.orig/src/settings/plugins/ofono/plugin.c	2015-04-27 16:22:21.000000000 -0400
+++ network-manager-0.9.10.0/src/settings/plugins/ofono/plugin.c	2015-04-28 07:05:51.388669179 -0400
@@ -179,6 +179,9 @@
 	GKeyFile *keyfile = NULL;
 	GError *tmp_error = NULL;
 
+	if (g_strstr_len (imsi, -1, "/") != NULL)
+		goto patherror;
+
 	imsi_path = g_strdup_printf (OFONO_CONFIG_DIR "/%s", imsi);
 	imsi_dir = g_dir_open (imsi_path, 0, NULL);
 
@@ -246,6 +249,7 @@
 		return TRUE;
 	}
 
+patherror:
 	if (tmp_error) {
 		g_propagate_error (error, tmp_error);
 		g_clear_error (&tmp_error);
